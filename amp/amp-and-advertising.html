---
title: „AMP und Werbung“
description: „In diesem Thema erfahren Sie, wie Sie Werbung mit einem Brightcove Player anzeigen, der AMP verwendet. Sie lernen auch, wie Sie die clientseitige Zustimmung mit der Brightcove Player/AMP-Konfiguration verwenden. „
parent: "amp"
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
    <summary>{{ page.description }}</summary>
    <section class="bcls-section">
        <h2 id="section-name">Implementierung von Werbung in einem AMP-Spieler</h2>
        <p>Werbung, einschließlich Prerolls, funktioniert bei Spielern, die in AMP verwendet werden. Das Anzeigen-Plugin und seine Konfiguration müssen nur in die Konfiguration des Spielers aufgenommen werden. Wenn Sie artikelspezifische Werte in Ihre Anzeigen-Server-Anrufe aufnehmen müssen, können Sie benutzerdefinierte Daten wie später in diesem Dokument beschrieben an ein Player-Plugin weitergeben.</p>
        <p>AMP ist sehr streng in dem, was zu einer gültigen AMP-Seite hinzugefügt werden kann, wie im</a> Dokument „ <a href="/amp/amp-using-video-cloud-video.html">AMP Using a Video Cloud Video Video“ beschrieben. Beispielsweise können Sie NICHT die Standardpraxis verwenden, ein <code translate="No">id</code> zum <code translate="No">amp-brightcove</code> Tag hinzuzufügen und dann eine <code translate="No">script</code> blockieren, um beispielsweise das IMA3-Plugin zu konfigurieren.</p>
        <p>Um dies noch einmal zu wiederholen, muss Werbung in der Konfiguration des Spielers implementiert werden, entweder mit Studio oder der Player Management API.</p>
        <p>Wenn Sie Anzeigenkonfigurations-URLs verwenden möchten, die ein Anzeigenmakro verwenden <code translate="No">{pageVariable.<span class="bcls-highlight">adId</span>}</code>, wie z. B., müssen Sie die Konfiguration des Spielers ändern. Sie können einen benutzerdefinierten Parameter verwenden wie:</p>
        <pre class="line-numbers">
  <code class="language-html" translate="No">data-param-ad-id="preonlybumper"</code></pre>
        <p>Dies macht den Wert nicht automatisch für das Anzeigenmakro verfügbar <code translate="No">{pageVariable.adId}</code>. Um die <code translate="No">ad-id/adId</code> Eigenschaft für die Anzeigen-URL verfügbar zu machen, müssen Sie die</a> Konfigurationsoption <a href="/general/player-configuration-guide.html#query_string_to_window">query_string_to_window von Brightcove Player verwenden. Diese Option steuert die Population der globalen Namespace-Variablen (Fenster) aus Abfragezeichenfolgenparametern. Um alle Abfragezeichenfolgenparameter zum globalen Namespace hinzuzufügen, fügen Sie Ihrer Player-Konfiguration Folgendes hinzu:
            <pre class="line-numbers">
<code class="language-bash" translate="No">"query_string_to_window": {
  "target": "queryStringParams"
}</code></pre>
            <p>Beachten Sie, dass der</code> Name <code translate="no">QueryStringSparams die „Variable“ ist, in der die Parameter gespeichert werden, und Sie können den Namen nach Belieben ändern.</p>
            <p>Wenn Sie aus irgendeinem Grund dem globalen Namespace nur begrenzte Parameter zuweisen möchten, können Sie dies tun. Um beispielsweise nur das Plugin <code class="language-html" translate="No">data-param-<span class="bcls-highlight">ad-id</span>="..."</code> verfügbar zu machen, fügen Sie der Player-Konfiguration Folgendes hinzu:</p>
            <pre class="line-numbers">
<code class="language-bash" translate="No">"query_string_to_window": {
  "globals": [
    "adId"
  ]
}</code></pre>
            <p>Spezielle Anweisungen zum Aktualisieren einer Player-Konfiguration finden Sie unter <a href="https://apis.support.brightcove.com/player-management/references/reference.html#operation/UpdatePlayerConfiguration">Player-Konfigurationen - Aktualisieren einer Player-Konfiguration</a> über die Player Management-API-Referenz.</p>
    </section>
    <section class="bcls-section">
        <h2 id="section-name">Ampere-Einwilligung und Werbung</h2>
        <p>In AMP können Sie die clientseitige Zustimmung verwenden und Benutzern zusätzliche Kontrolle über ihre Online-Erfahrung geben. Wenn Ihre AMP-Seite die Benutzereinwilligung mit AMP-Zustimmung verwaltet und Sie Werbung im Player verwenden, möchten Sie möglicherweise die Anzeigenanfrage des Spielers abhängig von dieser Zustimmung anpassen. Tun Sie dies, indem Sie ein
            <pre><code class="language-javascript">data-block-on-consent="_till_antwortet“</code></pre>
            dem amp-brightcove-Element zuschreiben. Dies führt dazu, dass sich die Ladung des Spielers verzögert, bis der Benutzer die Zustimmung akzeptiert oder abgelehnt hat. Auf nachfolgenden Seiten, auf denen die Zustimmung bekannt ist, wird der Spieler ohne Verzögerung normal geladen.</p>
        <aside class="bcls-aside bcls-aside--information">Weitere Informationen zur Zustimmung der AMP-Benutzer finden Sie im</a> Dokument zum <a href="https://amp.dev/documentation/examples/user-consent/client_side_user_consent_flow/">clientseitigen Benutzerzustimmungsfluss von AMP.</aside>
        <h3>Anzeigenkonfigurationen</h3>
        <p>Das einfachste Szenario zur Implementierung von Werbung und AMP besteht darin, die Standard-IMA-Werbeintegration von Brightcove Player mit Google Ad Manager zu verwenden, die erwartet, dass <code translate="no">npa=1</code> zur Anzeigenanfrage hinzugefügt wird, wenn die Zustimmung unbekannt ist oder nicht erteilt wird. Um dies zu tun, füge hinzu</p>
            <pre><code class="language-javascript">„imaAddNpa“: wahr</code></pre>
            <p>zu den Optionen des AMP Support Plugins des Spielers, und dies wird automatisch zur Ad-Server-URL hinzugefügt, wie hier gezeigt:</p>
        <figure class="bcls-figure">
            <img class="bcls-image" src="/assets/images/amp/amp-ad-plugin-config.png" alt="plugin configuration">
        </figure>
        <p>Für andere Änderungen an der Anzeigenserver-URL wird der Zustimmungsstatus im Iframe des Spielers mit drei Abfrageparametern festgelegt:</p>

        <ul>
            <li><code translate="no">ampInitialConsentState</code>: Ob die Einwilligung akzeptiert, abgelehnt, unbekannt</li>
            <li><code translate="no">AmpConsentSharedData</code>: Eine JSON-Datenfolge des Einwilligungsanbieters</li>
            <li><code translate="no">ampInitialConsentValue</code>: Die Einwilligungszeichenfolge des Zustimmungsanbieters</li>
        </ul>

        <p>Der Zustimmungsstatus ist eine Ganzzahl wie in AMP definiert:</p>

        <ul>
            <li>AUSREICHEND: 1</li>
            <li>UNZUREICHEND: 2</li>
            <li>UNBEKANNT_NOT_REQUIRED: 3</li>
            <li>UNBEKANNT: 4</li>
        </ul>

        <p>Um die Player-Konfiguration zu aktualisieren, um die Abfrageparameter des Players Iframe als einfache Javascript-Variablen verfügbar zu machen, fügen Sie der Player-Konfiguration im JSON-Editor Folgendes hinzu:</p>
        <pre><code class="language-javascript">„query_string_to_window“: {"target": "queryStringParams"}</code></pre>
        <p>Für Unterstützung finden Sie hier einen Screenshot der Benutzeroberfläche:
        </p>
        <figure class="bcls-figure">
            <img class="bcls-image" src="/assets/images/amp/amp-ad-json-editor.png" alt="JSON editor">
        </figure>
        <p>Dann können Sie die Parameter für die Einwilligungsabfrage in der Anzeigen-Server-Anfrage verwenden, entweder mit Makros oder indem Sie die SeverUrl als Funktion konfigurieren.</p>
        <h4>Beispiel für Makro</h4>
        <pre><code class="language-javascript">„adserVerurl“: "https://ads.example.com/ad?consent ={pageVariable.queryStringParams.ampInitialConsentState}&amp;consentString={pageVariable.queryStringParams.ampInitialConsentValue}"</code></pre>
        <h4>Beispiel für eine Funktion</h4>
        <p>Konfigurieren Sie den Player ohne Anzeigenserver-URL mit den folgenden Eigenschaften:</p>
        <pre><code class="language-javascript">videojs.registerPlugin ('setadUrl', function () { this.ima3.settings.serverUrl = function(callback) { if (window.queryStringParams.ampInitialConsentState === 1) { // Sufficient consent callback('https://ads.example.com/adwithconsent?string={pageVariable.queryStringParams.ampInitialConsentValue}');} sonst { // Use a different ad callback('https://ads.example.com/basicad'); }});</code></pre>


    </section>
</article>