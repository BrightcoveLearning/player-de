---
title: 'Beispiel für Brightcove Spieler: Audio-Plugin herunterladen'
description: 'In diesem Thema erfahren Sie, wie Sie einen Link erstellen, mit dem Sie MP4 in bester Qualität eines Audio-Assets herunterladen können, das im Brightcove Player gespielt wird. Der Code wird geschrieben und erklärt und später im Dokument in ein Plugin umgewandelt, um es einfach mit verschiedenen Spielern zu verwenden.'
parent: Code Samples
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

  <aside class="bcls-aside bcls-aside--information">Der Inhalt in diesem Dokument gilt nur für Video Cloud. Da iOS-Geräte kein vom Benutzer zugängliches Dateisystem haben, funktioniert das Plugin nicht auf iOS-Geräten.</aside>
  <section class="bcls-section">
    <h2 id="Player_example">Beispiel eines Spielers</h2>
    <!-- UPDATE description -->
    
    <aside class="bcls-aside bcls-aside--information">Dieses Beispiel und der zugehörige Code werden als Leitfaden für Ihre Produktionsentwicklung bereitgestellt. Der Code ist weder für die Verwendung in der Produktion zertifiziert noch offiziell unterstützt.</aside>
    <p>Sie sehen einen gestalteten Brightcove Player zum Abspielen von Audio-Assets. Nachdem Sie auf „Abspielen“ geklickt haben, sehen Sie auf der rechten Seite der Steuerleiste ein Download-Symbol. Wenn Sie auf dieses Symbol klicken, wird das wiedergespielte Audio-Asset über den Browser heruntergeladen.</p>
    <p>Es gibt ein SEHR ähnliches Beispiel, das Video anstelle von Audio-Assets im <a href="/code-samples/brightcove-player-sample-download-video-plugin.html">Brightcove Player-Beispiel verwendet: Laden Sie das Video Plugin</a> Dokument herunter.</p>
    <!-- UPDATE codepen here -->
    
    <p class="codepen" data-height="413" data-theme-id="34967" data-default-tab="result" data-user="rcrooks1969" data-slug-hash="QodMJe" style="height: 413px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1em 0; padding: 1em;" data-pen-title="Download Audio Plugin"><span>Siehe das <a href="https://codepen.io/team/rcrooks1969/pen/QodMJe/"> Stift-Download-Audio-Plugin</a> von Brightcove Learning Services (<a href="https://codepen.io/rcrooks1969">@rcrooks1969</a>) auf <a href="https://codepen.io">CodePen</a>.</span></p>
    <script async src="https://static.codepen.io/assets/embed/ei.js"></script><!-- UPDATE link to GitHub source -->
    
    <br/>
    <aside class="bcls-aside bcls-aside--tip">VERHALTEN ZUM DOWNLOAD VON BRO Browser haben die Art und Weise geändert, wie sie mit Dateidownloads umgehen. Safari, Firefox und Chrome öffnen das heruntergeladene Video alle in einem neuen Fenster oder Tab, was im Allgemeinen kein gewünschtes Verhalten ist. Aus diesem Grund verwendet dieses Beispiel ein clientseitiges JavaScript-Tool, um Browser dazu zu zwingen, das Video ordnungsgemäß herunterzuladen. Ausführliche Informationen zum Tool finden Sie unter <a href="https://www.npmjs.com/package/downloadjs">https://www.npmjs.com/package/downloadjs</a>.</aside>
    
    <h3>Quellcode</h3>
          <p>Sehen Sie sich die <a href="https://github.com/BrightcoveLearning/18743-download-audio-plugin">Komplettlösung auf GitHub an</a>.</p>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Using_the_CodePen">CodePen verwenden</h2></summary>
      <p>Hier sind einige Tipps zur effektiven Verwendung des obigen CodePen:</p>
      <ul>
        <li>Schalten Sie die tatsächliche Anzeige des Spielers um, indem Sie auf die</strong> Schaltfläche <strong translate="No">Ergebnis klicken.</li>
        <li>Klicken Sie auf die</strong> Schaltflächen <strong translate="No">HTML/CSS/JS, um EINEN der Codetypen anzuzeigen.</li>
        <li>Später in diesem Dokument werden die Logik, der Ablauf und das Styling der Anwendung in der <a href="#Player/HTML_configuration">Player/HTML-Konfiguration</a>, im <a href="#Application_flow">Anwendungsfluss</a> und im <a href="#Application_styling">Anwendungsstyling diskutiert</a> Abschnitte. Der beste Weg, um den Informationen in diesen Abschnitten zu folgen, besteht darin:
          <ol>
            <li>Klicken Sie im CodePen auf die</strong> Schaltfläche <strong translate="No">EDIT ON CODEPEN und halten Sie den Code in einem Browser-/Browser-Tab zur Verfügung.</li>
            <li>Passen Sie in CodePen an, welcher Code angezeigt werden soll. Sie können die Breite verschiedener CodeAbschnitte in CodePen ändern.</li>
            <li>Zeigen Sie die</a> Abschnitte <a href="#Player/HTML_configuration">Player/HTML-Konfiguration</a>, <a href="#Application_flow">Anwendungsfluss</a> und/oder <a href="#Application_styling">Anwendungs-Styling in einer anderen Browser-/Browser-Registerkarte an. Sie können nun den Codeerklärungen folgen und gleichzeitig den Code anzeigen.</li>
          </ol>
        </li>
      </ul>
    </details>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Development_sequence">Entwicklungs-Sequenz</h2></summary> 
      <p>Hier ist die empfohlene Entwicklungssequenz:</p>
      <ol>
        <li>Verwenden Sie die In-Page-Embed-Player-Implementierung, um die Funktionalität Ihres Players, Plugins und CSS zu testen (falls CSS benötigt wird)</li>
        <li>Legen Sie JavaScript und CSS des Plugins in separate Dateien zum lokalen Testen</li>
        <li>Stellen Sie den Plugin-Code und das CSS auf Ihrem Server bereit, sobald Sie Fehler herausgefunden haben</li>
        <li>Benutze Studio, um das Plugin und das CSS deinem Player hinzuzufügen</li>
        <li>Ersetzen Sie die In-Page-Embed-Player-Implementierung, wenn Sie feststellen, dass die Iframe-Implementierung besser passt (im nächsten Abschnitt beschrieben)</li>
      </ol>
      <p>Weitere Informationen zu diesen Schritten finden Sie in der <a href="/coding-topics/step-step-plugin-development.html">Schritt-für-Schritt-Anleitung: </a> Leitfaden zur Entwicklung von Plugins</p>
      <h3>iframe oder In-Page einbetten</h3>
      <p>Bei der Entwicklung von Verbesserungen für den Brightcove Player müssen Sie entscheiden, ob der Code am besten für die Iframe- oder In-Page-Einbettungsimplementierung geeignet ist. Die Best Practice-Empfehlung besteht darin, ein Plugin zur Verwendung mit einer Iframe-Implementierung zu erstellen. Die Vorteile der Verwendung des iFrame-Players sind:</p>
      <ul>
        <li>Keine Kollisionen mit vorhandenem JavaScript und/oder CSS</li>
        <li>Reaktionsschnell</li>
        <li>Der iframe erleichtert die Verwendung in Social-Media-Apps (oder wann immer das Video in andere Apps „reisen“ muss)</li>
      </ul>
      <p>Obwohl die Integration des In-Page-Einbettungsplayers komplexer sein kann, planen Sie Ihren Code in dieser Implementierung manchmal. Um zu verallgemeinern, ist dieser Ansatz am besten, wenn die enthaltende Seite mit dem Spieler kommunizieren muss. Im Einzelnen sind hier einige Beispiele:</p>
      <ul>
        <li>Der Code auf der enthaltenden Seite muss Spielerereignisse abhören und darauf reagieren</li>
        <li>Der Player verwendet Stile von der enthaltenden Seite</li>
        <li>Der Iframe führt dazu, dass die App-Logik fehlschlägt, wie eine Weiterleitung von der enthaltenen Seite</li>
      </ul>
      <p>Selbst wenn Ihre endgültige Implementierung den Iframe-Code nicht verwendet, können Sie den In-Page-Einbettungscode trotzdem mit einem Plugin für Ihr JavaScript und einer separaten Datei für Ihr CSS verwenden. Dies kapselt Ihre Logik, sodass Sie sie problemlos in mehreren Spielern verwenden können.</p>
    </details>
  </section>
  <section class="bcls-section">
    <h2 id="API/Plugin_resources_used">Verwendete API/Plugin-Ressourcen</h2>
    <!-- UPDATE table, remove unneeded columns -->
    
    <table class="bcls-table">
      <thead class="bcls-table__head">
        <tr>
          <th>API-Methoden</th>
          <th>API-Ereignisse</th>
          <th>API-Eigenschaften</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/module-events.html#.on"><code translate="No">on()</code></a></td>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/Player.html#event:loadstart"><code translate="No">loadstart</code></a></td>
          <td><a href="/references/video-metadata-mediainfo.html"><code translate="No">player.mediainfo</code></a></td>
        </tr>
        <tr>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/CustomControlSpacer.html"><code translate="No">player.controlBar.customControlSpacer</code></a></td>
        </tr>
      </tbody>
    </table>
    <!-- <aside class="bcls-aside bcls-aside--tip">This code sample uses one of the Brightcove REST APIs. To understand working with this API it is vital you read and understand the <a href="/getting-started/learning-guide-using-rest-apis.html">Learning Guide: Using the REST APIs</a> document.</aside> --></section>
  <!-- UPDATE player and HTML configuration -->
  
  <section class="bcls-section">
    <h2 id="Player/HTML_configuration">Player-/HTML-Konfiguration</h2>
    <p>Dieser Abschnitt beschreibt jede spezielle Konfiguration, die während der Spielererstellung erforderlich ist. Darüber hinaus werden andere HTML-Elemente beschrieben, die der Seite über den In-Page-Einbettungsplayer-Implementierungscode hinaus hinzugefügt werden müssen.</p>
    <h3>Player-Konfiguration</h3>
    <p>Für den Brightcove Player, den Sie für dieses Beispiel erstellen, ist keine spezielle Konfiguration erforderlich.</p>
    <h3>Anderes HTML</h3>
    <p>Der Seite werden keine anderen HTML-Elemente hinzugefügt.</p>
  </section>
  <!-- UPDATE application flow -->
  
  <section class="bcls-section">
    <h2 id="Application_flow">Ablauf der Anwendung</h2>
    <p>Die grundlegende Logik hinter dieser Anwendung lautet:</p>
    <ul>
      <li>Holen Sie sich den Namen des Audio-Assets und extrahieren Sie die MP4-Formatvarianten aus dem Quellen-</li>
      <li>Durchlaufen Sie alle Formatvarianten und extrahieren Sie die MP4-Versionen.</li>
      <li>Sortieren Sie das MP4-Array nach dem <code translate="No">size</code> Attribut, das am größten bis kleinsten ist.</li>
      <li>Weisen Sie einer Variablen die größte Formatvariante zu.</li>
      <li>Erstellen Sie ein anklickbares Bild, das die Formatvariante in einem <code translate="No">div</code> HTML-Element herunterlädt.</li>
      <li>Platzieren Sie das Download-Asset-Image-Element im DOM.</li>
    </ul>
    <!-- UPDATE task 1 -->
    
    <h3>Holen Sie sich den Namen des Audio-Assets und extrahieren Sie die MP4-Formatvarianten aus dem</h3>
    <p>Finden Sie den Code, der mit der Bezeichnung versehen ist:</p>
    <pre>
<code class="language-javascript" translate="No">// ### Get video name and the MP4 renditions ###</code></pre>
    <p>Zuerst wird der <code translate="No">videoName</code> Variablen der Name des Videos&nbsp;(mit entfernten Leerzeichen) zur Verwendung in dem HTML-Anker-Tag zugewiesen, das später im Code dynamisch erstellt wurde. Als nächstes werden der <code translate="No">renditionsAra</code> Variablen alle möglichen Formatvarianten für das Video zugewiesen.</p>
    <p>Damit dieses Plugin korrekt funktioniert, müssen Sie natürlich mindestens eine MP4-Wiedergabe in den Quellen haben.</p>
    <!-- UPDATE task 2 -->
    
    <h3>Durchlaufen Sie alle Videowiedergaben und extrahieren Sie die MP4-Versionen</h3>
    <p>Finden Sie den Code, der mit der Bezeichnung versehen ist:</p>
    <pre>
<code class="language-javascript" translate="No">// ### Loop over videos and extract only MP4 versions ###</code></pre>
    <p>Schleife über das Array und weise dem zu <code translate="No">mp4Ara</code> variable Wiedergaben, bei denen die <code translate="No">container</code> ist <strong>MP4</strong> , UND die Wiedergabe hat a <code translate="No">src</code> Eigentum. Die MP4-Formatvarianten erscheinen zweimal im <code translate="No">sources</code> Array, einmal mit einer <code translate="No">src</code> Eigenschaft und einmal mit einem <code translate="No">stream_name</code> eigentum. Der erste ist für den progressiven Download und der zweite für das Streaming.</p>
    <p>Die folgenden Screenshots zeigen, dass die Konsole alle Formatvarianten und dann die gefilterten Formatvarianten in MP4-Formatvarianten anzeigt.</p>
    <figure class="bcls-figure"><img class="bcls-image" alt="All renditions" src="/assets/images/code-samples/brightcove-player-sample-download-audio-plugin/console-all-renditions.png" />
      <figcaption class="bcls-caption--image">Alle Formatvarianten</figcaption>
    </figure>
    <figure class="bcls-figure"><img class="bcls-image" alt="Only MP4 renditions after filtering" src="/assets/images/code-samples/brightcove-player-sample-download-audio-plugin/console-mp4-renditions-only.png" />
      <figcaption class="bcls-caption--image">Nur MP4-Formatvarianten nach dem Filtern</figcaption>
    </figure>
    <!-- UPDATE task 3 -->
    
    <h3>Sortieren Sie das MP4-Array nach dem <code translate="No">size</code> Attribut, das am größten zum kleinsten</h3>
    <p>Finden Sie den Code, der mit der Bezeichnung versehen ist:</p>
    <pre>
<code class="language-javascript" translate="No">// ### Sort the renditions from highest to lowest on size ###</code></pre>
    <p>Sortieren <code translate="No">mp4Ara</code> Sie die <code translate="No">sort()</code> Methode mit JavaScript</p>
    <!-- UPDATE task 3 -->
    
    <h3>Weisen Sie das größte Video einer Variablen zu</h3>
    <p>Finden Sie den Code, der mit der Bezeichnung versehen ist:</p>
    <pre>
<code class="language-javascript" translate="No">// ### Extract the highest rendition ###</code></pre>
    <p>Weisen Sie der <code translate="No">highestQuality</code> Variablen den Null-Indexwert aus dem sortierten MP4-Formatvarianten-Array zu.</p>
    <!-- UPDATE task 3 -->
    
    <h3>Erstellen Sie ein Element, das ein anklickbares Bild in einem <code translate="No">div</code> HTML-Element enthält</h3>
    <p>Finden Sie den Code, der mit der Bezeichnung versehen ist:</p>
    <pre>
<code class="language-javascript" translate="No">// ### Build the download image element ###</code></pre>
    <p>Oben im JavaScript-Code werden HTML <code translate="No">div</code> und <code translate="No">img</code> Elemente erstellt und in Variablen gespeichert. Diese Elemente werden dann manipuliert, um dynamisch ein HTML-Element zu erstellen, das als Download-Button fungiert. Ein Beispiel dafür, wie das dynamisch erstellte Element aussehen könnte, folgt:</p>
    <figure class="bcls-figure"><img class="bcls-image" alt="dynamically built download element" src="/assets/images/code-samples/brightcove-player-sample-download-audio-plugin/download-element.png" /></figure>
    <!-- UPDATE task 3 -->
    
    <h3>Platzieren Sie das Download-Schaltflächenelement im DOM</h3>
    <p>Finden Sie den Code, der mit der Bezeichnung versehen ist:</p>
    <pre>
<code class="language-javascript" translate="No">// ### Place the download button ###</code></pre>
    <p>In diesem Fall wird die Download-Button im Abstandshalter der Steuerleiste platziert. Zuerst wird ein Verweis auf das Abstandselement erhalten, dann wird ein Attribut definiert, das das neue Element im Abstandshalter positioniert, und zuletzt das neue Element im Abstandshalter platziert.</p>
  </section>
  <!-- UPDATE CSS description -->
  
  <section class="bcls-section">
    <h2 id="Application_styling">Styling der Anwendung</h2>
    <p>Das CSS macht zwei Jobs, sie sind:</p>
    <ul>
      <li>Stylt den Player für einen „Nur Audio“ -Look.</li>
      <li>Größe und positioniert den Download-Button zur Platzierung in der Steuerleiste.</li>
    </ul>
  </section>
  <section class="bcls-section">
    <h2 id="Plugin_code">Plugin-Code</h2>
    <p>Normalerweise sind bei der Umwandlung des JavaScript in ein Brightcove Player-Plugin nominelle Änderungen erforderlich. Eine erforderliche Änderung besteht darin, die Standardverwendung der <code translate="No">ready()</code> Methode durch den Code zu ersetzen, der ein Plugin definiert.</p>
    <p>Hier ist der sehr häufig verwendete Start zu JavaScript-Code, der mit dem Player funktioniert:</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').ready(function() {
  var myPlayer = this;
  ...
});</code></pre>
    <p>Sie ändern die erste Zeile, um die Standardsyntax zum Starten eines Brightcove Player-Plugins zu verwenden:</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.registerPlugin('pluginName', function(options) {
  var myPlayer = this;
  ...
});</code></pre>
    <!-- UPDATE path to plugin's JavaScript -->
    
    <aside class="bcls-aside bcls-aside--tip">Da das Plugin nicht mit iOS funktioniert, möchten Sie diesen Code möglicherweise dem Plugin hinzufügen, um zu verhindern, dass das Plugin überhaupt versucht, auf iOS herunterzuladen:
      <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.registerPlugin('downloadVideo', function() {
  if (videojs.browser.IS_IOS) {
    return;
  }

  // rest of the plugin...
});</code></pre>
    </aside>
    <p>Wie bereits erwähnt, können Sie den JavaScript-Code des Plugins im entsprechenden GitHub Repo dieses Dokuments sehen: <a href="https://github.com/BrightcoveLearning/18743-download-audio-plugin/blob/master/plugin/download-audio.js">download-audio.js</a>.</p>
    <h3>Verwenden des Plugins mit einem Player</h3>
    <p>Sobald Sie die CSS- und JavaScript-Dateien des Plugins an einem für das Internet zugänglichen Ort gespeichert haben, können Sie das Plugin mit einem Player verwenden. Im</strong> PLAYER-Modul von <strong>Studio können Sie einen Player auswählen, dann im</strong> Abschnitt <strong>PLUGINS die URLs zu den CSS- und JavaScript-Dateien hinzufügen und auch den <strong>Namen hinzufügen</strong> und <strong>Optionen</strong>, wenn Optionen benötigt werden.</p>
    <aside class="bcls-aside bcls-aside--tip">Weitere Informationen zur Verwendung von Studio zum Zuweisen von Plugins zu Spielern finden Sie im</a> Dokument <a href="https://studio.support.brightcove.com/players/configuring-player-plugins.html">Configuring Player Plugins.</aside>
  </section>
  <section class="bcls-section">
    <h2 id="Version_5_backwards_compatibility">Version 5 Abwärtskompatibilität</h2>
    <p>Wenn Sie möchten, dass das Plugin mit beiden Versionen 5 und 6 funktioniert, müssen einige Änderungen am JavaScript vorgenommen werden. Die Änderungen werden aufgelistet, dann wird ein Skelett des JavaScript angezeigt.</p>
    <ol>
      <li>Fügen Sie oben in der JavaScript-Datei die folgende Variablendeklaration hinzu. Die Variable definiert, wie ein Plugin sowohl für Version 5 als auch für Version 6 registriert wird:
        <pre class="line-numbers">
<code class="language-javascript" translate="No">var registerPlugin = videojs.registerPlugin || videojs.plugin;</code></pre>
      </li>
      <li>Ändern Sie die alte erste Zeile des JavaScript von:
        <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').ready(function() {</code></pre>
        zu
        <pre class="line-numbers">
<code class="language-javascript" translate="No">registerPlugin("downloadAudio", function() {</code></pre>
      </li>
      <li>Erstellen Sie eine Funktion unter dem vorhandenen Code, der das jetzt definierte Plugin aufruft:
        <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').ready(function() {
  var player = this;
  player.downloadAudio();
});</code></pre>
      </li>
      <li>Stellen Sie sicher, dass die Struktur des Codes wie folgt angezeigt wird:
        <pre class="line-numbers">
<code class="language-javascript" translate="No">var registerPlugin = videojs.registerPlugin || videojs.plugin;

registerPlugin("downloadAudio", function() {
  // Create variables and new div, anchor and image for download icon
  var myPlayer = this,
    videoName,
    totalRenditions,
    mp4Ara = [],
    highestQuality,
    spacer,
    newElement = document.createElement("div"),
    newImage = document.createElement("img");

    // REST OF JavaScript
    ...
});

videojs.getPlayer('myPlayerID').ready(function() {
  var player = this;
  player.downloadAudio();
});</code></pre>
      </li>
    </ol>
  </section>
</article>